# 第四章：指令系统

![image-20200606172046447](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606172046447.png)

![image-20200606173238742](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606173238742.png)

![image-20200606173300190](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606173300190.png)

## 4.1 指令系统的发展与性能要求



计算机的**程序是由一系列的指令组成**的。

**指令**：就是要计算机执行某种操作的命令。

> 从计算机组成的层次结构来说，计算机的指令有*微指令*、*机器指令*和*宏指令*。

1. 微指令：微程序级的命令，属于硬件；
2. 宏指令：由若干条机器指令组成的软件指令，属于软件；
3. 机器指令：介于微指令与宏指令之间，每条指令可以完成一个独立的算术运算或逻辑运算。
4. 指令系统：一台计算机中所有机器指令的集合，它是决定一台计算机性能的重要因素，其格式与功能不仅直接影响到机器的硬件结构，也直接影响到系统软件，影响到机器的适用范围。（一个完善的指令系统应满足如下四方面的要求：						                                        完备性、有效性、规整性、兼容性。

*一条指令必须明显或隐含包含的信息有*：

**1.操作码**

**2.源操作数或其地址**

**3.结果的地址**

**4.下一条指令的地址**



## 4.2 指令格式

指令字（简称指令）：表示一条指令的机器字。
指令格式：是指令字用二进制代码表示的结构形式，由操作码字段和地址码字段组成。

> ·操作码字段：表示指令的操作特性与功能；
> ·地址码字段：通常指定参与操作的操作数的地址。

<img src="C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606145114070.png" alt="image-20200606145114070" style="zoom: 50%;" />

指令格式的选择应遵循的几条基本原则

- 应尽量短
- 要有足够的操作码位数
- 指令编码必须有唯一的解释，否则是不合法的
- 指令指令字长应是字节的整数倍
- 合理地选择地址字段的个数
- 指令尽量规整

![image-20200606174629916](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174629916.png)

### 4.2.1操作码

操作码：用于指明指令要完成的操作功能及其特性。指令系统中的每一条指令都有一个唯一确定的操作码，用以指示指令的操作功能。不同的指令具有不同的操作码。

>为了能表示指令系统中的全部操作，指令字中必须有足够长度的操作码字段。假定指令系统中有m种操作，则操作码位数n应满足：	n≥1og2m
>
>

#### 定长编码的指令操作码

·所有指令的操作码长度一致，位置固定。是一种简单规整的编码方法。
·定长编码操作码的特点：

>位数和位置固定，指令译码简单，有利于简化硬件设计。
>在字长较长的大、中型机以及超小型机中定长编码的操作码被广泛采用，
>例如：在IBM360/370机中，所有指令的操作码均为8位，最多可指定256种操作。

#### 变长编码的指令操作码

不同指令的操作码长度不完全相同，操作码的位数不固定，分散地放在指令字的不同位置上。
变长编码操作码的特点：

>可用较短的指令字长表示更多的操作类型，寻址较大的存储空间。
>操作码的位数不固定，且位置分散，增加了指令译码与分析的难度，使硬件设计复杂化。
>在早期的微、小型机中，由于指令字较短，均采用变长编码的指令操作码。如Intel8086、PDP一11等机器。

#### 扩展操作码的方法

- 最常用的变长操作码的编码方式是扩展操作码法。
- 扩展操作码法：当指令长度一定时，将操作数地址多的指令选择短的操作码，操作数地址少的指令选择较长操作码。
- 采用扩展操作码法即能充分地利用指令字的各个字段，又能在不增加指令长度的情况下扩展操作码长度，使它能表示更多的指令。

![image-20200606150951611](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606150951611.png)

![image-20200606151014477](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606151014477.png)

![image-20200606151023831](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606151023831.png)

在进行操作码扩展的过程中，必须注意的是：

1. 不同指令的操作码编码一定不能重复。
2. 在设计不同长度的操作码时，要尽量考虑安排指令使用频度高的指令使用短的操作码，使用频度低的指令使用较长的操作码。
   这样可以缩短经常使用的指令的译码时间，加快系统整体的运行速度。

### 4.2.2地址码

![image-20200606154155736](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606154155736.png)

#### 三地址指令

![image-20200606154314704](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606154314704.png)

特点：

- 编程方便，结果不影响运算操 作数，但指令长度仍比较长 
- 一般在字长较长的大、中型机中使用，而 微、小型机中很少使用三个地址均为存储器地址的三地址指令。 

#### 二地址指令

![image-20200606154422427](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606154422427.png)

S-S型：两操作数均在存储器，A1、A2是存储器地址（执行速度慢

R-R型：两操作数均在寄存器，A1、A2是寄存器地址

R-S型：A1、A2一个寄存器地址一个存储器地址

#### 一地址指令

① 单操作数指令：如INC、DEC等，只需一个操作数， 其功能为：OP(A)→A   
② 双操作数指令：另一个操作数通常采用隐含寻址的 方法，将操作数隐含在约定的累加器AC中，其指令功能为：       (AC)OP(A)→AC 

#### 零地址指令

① 不需操作数的控制型指令，如HALT、WAIT、 NOP等。 
② 运算型零地址指令：操作数隐含在堆栈中。 

### 4.2.3指令长度

- 指令字长度：一个指令字中包含二进制代码的 位数。
- 机器字长：计算机能直接处理的二进制数据的 位数，它决定了计算机的运算精度。
  - 单字长指令：指令长度等于机器字长度；
  - 半字长指令：指令长度等于半个机器字长 度的指令；
  - 双字长指令：指令长度等于两个机器字长 度的指令。 

等长指令字结构: 各种指令字长度是相等的。这种指令字结构简单，且指令字长度是不变的。 
变长指令字结构: 指令字的长度随指令功能而变化。这种指令字结构灵活，能充分利用指令长度，但指令的译码及控制较复杂。 

### 4.2.3指令助记符

每条指令通常用3 个或4个英文缩写字母来表示。这种缩写字符叫做**指令助记符**。 

![image-20200606155948815](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606155948815.png)

> 在不同的计算机中，指令助记符的规定是不一 样的。
>
> 指令助记符还必须转换成与它们相对应的二进制码（机器码）。这种转换借助汇编程序可以 自动完成，汇编程序相当于一个“翻译”。 

### 指令格式特点分析

![image-20200606160101538](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606160101538.png)

![image-20200606160111013](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606160111013.png)

### 标志信息

条件转移指令（分支指令）通常根据程序当前生成的标志信息进行转移。
标志信息也称为条件码（Condnition Code）或状态位（Status）。

常见的标志：

零标志ZF、溢出标志OF、符号标志SF、进位/错位标志CF

![image-20200606160805897](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606160805897.png)



## 4.3  指令和数据的寻址方式 

1. 操作数或指令的地址：某个操作数或某条指令存放 在某个存储单元时，其存储单元的编号，就是该操作数 或指令在存储器中的地址。 
2. 寻址方式：形成指令或操作数的内存地址的方式。 
3. 寻址方式的类别：  
   （1）指令寻址方式，用于形成指令在内存中的地址。
   （2）数据寻址方式，用于形成操作数在内存中的地址 

### 4.3.1  指令的寻址方式 

#### 	1、顺序寻址方式

​	指令一条条顺序执行。
​	必须使用程序计数器（又称指令指针寄存 器）PC来计数指令的顺序号，该顺序号就是指令在内存中的地	址。 

#### 	2、跳跃寻址方式 

下条指令的地址码不是顺序地由程序计数器PC给出，而是由本条指令给出。 

![image-20200606161516933](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606161516933.png)



### 4.3.2  操作数寻址方式 

**定义：**形成操作数的有效地址的方法，称为: 操作数的寻址方式。 

操作数寻址方式：是处理器根据指令中给出的地址信息来寻找物理地址的方式。（从物理地址中取操作数

常用的主要有10种寻址方式： • 立即寻址  • 直接寻址  • 间接寻址  • 隐含寻址 • 寄存器寻址 • 寄存器间接寻址 • 相对寻址  • 基址寻址  • 变址寻址  • 基址变址寻址 

#### 1.立即寻址：

​		操作数就在指令的操作码中，此操作数也称立即数

#### 2.直接寻址：

​		在指令的地址码字段直接给出操作数所在主存单元的地址。 <img src="C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606162458419.png" alt="image-20200606162458419" style="zoom: 67%;" />



#### 3.间接寻址：

​		指令的地址码字段给出的是操作数所在内存单元 的地址的地址。 （需访问两次内存<img src="C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606162643233.png" alt="image-20200606162643233" style="zoom: 67%;" />



#### 4.寄存器寻址：

​		指令地 址码中给出的是某一通用寄存器的编号（也称寄存器地址）
​		该寄存器的内容即为指令所需的操作数。



#### 5.寄存器间接寻址：

​		是以寄存器中的内容作为操作数的地址，而操作数本身存放在存储器中。 ![image-20200606163037958](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606163037958.png)



#### 6.相对寻址（偏移寻址：

​		将程序计数器**PC**的内容与指令中给出的**形式地址**（偏移量）的值**相加**，形成操作数的有效地址。 
​		（对于短跳转和程序的再定位很有用![image-20200606163905278](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606163905278.png)



#### 7.基址寻址（偏移寻址：

​		指令中的		**地址码字段**A给出**偏移量**	显式或隐式给出的**基址寄存器**B给出**基准地址**

​		操作数的有效地址：**EA = B + （A）**

> 基址寄存器的内容称为基地址。 
> 基址寄存器的内容通常由操作系统或管理程 序设定。 
>
> 主要用于将用户程序的逻辑地址转换成主存的 实际地址。它面向系统，解决程序重定位和扩大寻址空间等问题。 

![image-20200606164059429](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606164059429.png)

#### 8.变址寻址（偏移寻址：

​		主要用于对线性表之类的数组元素进行方便的访问。
​		常用于字符串处理、数组运算等成批数据处理中，主要是面向用户，解决程序循环控制问题。 

指令中的		**地址码字段**A给出**基准地址**	显式或隐式给出的**变址寄存器**I给出**偏移量**
操作数的有效地址：**EA = A +（I）**

![image-20200606163631980](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606163631980.png)



#### 9.其他寻址方式：

基址变址寻址 ：EA=A+B+I

隐含寻址：指令中不给出操作数的地址，操作数约定在某个特定的寄存器或堆栈中 

#### 实例：

![image-20200606165528970](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606165528970.png)

​		



## 4.4  典型指令 

### 4.4.1  指令的分类 

#### 1.数据传送类指令 ：

- 数据传送指令主要包括取数指令、存数指令、传送指令、成组传送指令、字节交换指令、清累加器指令、堆栈操作指令等。 
- 这类指令主要用来实现主存和寄存器之间 或寄存器和寄存器之间的数据传送。 

#### 2.算术运算类指令 ：

- 这类指令包括二进制定点加、减、乘、 除指令，浮点加、减、乘、除指令，求反、求补指令，算术移位指令，算术比较指令，十进制加、减运算指令等。
- 这类指令主要用于定点或浮点的算术运算，大型机中有向量运算指令，直接对整个向量或矩阵进行求和、求积运算。 

#### 3.逻辑运算类指令 

- 这类指令包括逻辑加、逻辑乘、按位加、 逻辑移位等指令。 
- 主要用于无符号数的位操作、代码的转 换、判断及运算。 移位指令用来对寄存 器的内容实现左移、右移或循环移位。 

#### 4.程序控制类指令 

- 程序控制指令也称转移指令。
- 条件转移指令，执行程序时，有时机器执行到某条指令时，出现了几种不同结果，机器必须执行一条转移指令，根据不同结果进行转移,以改变程序原来 执行的顺序。 
- 除各种条件转移指令外，还有无条件转移指令、转子程序指令、返回主程序指令、中断返回指令等。  
- 转移地址一般采用直接寻址和相对寻址方式来确定 

#### 5.输入输出类指令 

- 输入输出指令主要用来启动外围设备，检查 测试外围设备的工作状态，并实现外部设备 和CPU之间，或外围设备与外围设备之间的 信息传送。 

- 主机与外部设备之间交换的信息包括： 

  1.输入/输出的数据 

  2.主机向外部设备发出各种控制命令

  3.外部设备的各种工作状态 

#### 6.字符串处理指令 

- 字符串处理指令是一种非数值处理指令， 一般包括字符串传送、字符串转换（把一种编码的字符串转换成另一种编码的字符串）、字符串替换（把某一字符串用另一 字符串替换）等。 
- 这类指令在文字编辑中对大量字符串进行 处理。  

#### 7.特权指令

- 特权指令是指具有特殊权限的指令。 
- 这类指令只用于操作系统或其他系统软件，一 般不直接提供给用户使用。  
- 在多用户、多任务的计算机系统中特权指令必 不可少。
- 它主要用于系统资源的分配和管理。包括改变系统工作方式、检测用户的访问权限、修改虚拟存储器管理的段表、页表以及完成进程的创建与切换等。 

#### 8.其他指令 

​	除以上各类指令外，还有状态寄存器置位、复位指令、测试指令、暂停指令， 空操作指令，以及其他一些系统控制用 的特殊指令。 



### 4.4.2  复杂指令系统计算机 CISC

特点：

1. 指令系统复杂       变长操作码 / 变长指令字 / 指令多 / 寻址方式多 / 指令格式多。
2. 指令周期长        绝大多数指令需要多个时钟周期才能完成 
3. 各种指令都能访问存储器        除了专门的存储器读写指令外，运算指令也能访问存储器
4. 采用微程序控制 
5. 有专用寄存器
6. 难以进行编译优化来生成高效目标代码 

### 4.4.3  精简指令系统计算机 RISC

RISC结构优先选取*使用频率最高的简单指令，* *抛弃复杂指令，固定指令长度，减少指令格式和寻址方式，以控制逻辑为主，不用或少用微码控制*等措施以达到用简单指令提高器性能和速度、提高机器的性能价格比的目的

特点：

1. 选取使用频率高的简单指令以及很有用但又 不复杂的指令组成指令系统。
2. 指令数目较少，指令长度固定，指令格式少， 寻址方式种类少。
3. 采用流水线技术，大多数指令可在一个时钟周期内完成；特别是在采用了超标量和超流 水技术后，可使指令的平均执行时间小于一个时钟周期。
4. 使用较多的通用寄存器以减少访存。 
5. 以寄存器 — 寄存器方式工作，只有取数/存数(LOAD/STORE)指令访问存储器，其余指令 的操作都在寄存器之间进行。 
6. 控制器以组合逻辑控制为主，不用或少用微程序控制。  
7. 采用优化编译技术，力求高效率支持高级语言的实现。 

![image-20200606172021365](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606172021365.png)

![image-20200606172029822](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606172029822.png)

## 4.5程序的机器级表示 （MIPS

要求通过查表能看程序代码进行汇编和反汇编





![image-20200606173811067](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606173811067.png)

![image-20200606173837005](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606173837005.png)

### MIPS指令字段含义 

![image-20200606174221432](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174221432.png)

![image-20200606174233150](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174233150.png)

### MIPS机器代码示例

![image-20200606174318260](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174318260.png)

### MIPS通用寄存器

![image-20200606174343949](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174343949.png)

### MIPS寻址方式

![image-20200606174417826](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174417826.png)

### Example：汇编形式与指令的对应

![image-20200606174535671](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200606174535671.png)





# 第五章：中央处理器



## 5.1 CPU的功能和组成 

![image-20200607214556794](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607214556794.png)

### 1.功能

自动完成取指令和执行指令的任务的计算机部件称为**中央处理器**

四大功能：

1. **指令控制**
   程序的顺序控制称为指令控制。用于控制指令严格地按程序规定的顺序，逐条取出并加以执行。
2. **操作控制**
   一条指令的功能往往是由若干个操作信号的组合来实现的，因此，CPU负责管理并产生每条指令所对应的操作信号，并把各种操作信号送往相应的部件，从而控制这些部件按指令的要求进行动作
3. **时序控制**
   对各种操作的实施时间进行定时。在计算机中，各种指令的操作信号以及一条指令的整个执行过程都严格的时间要求，需要CPU设定规定的时序关系。
4. **数据加工**
   数据加工就是对数据进行算术运算和逻辑运算处理，这是CPU的核心功能之一。

### 2.基本组成

​		**控制器、运算器、cache**

![image-20200607145338568](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607145338568.png)

##### 控制器

###### 功能：

1. 控制指令的正确执行 
2. 控制程序和数据的输入及结果的输出 
3. 异常情况和特殊请求的处理 

###### 组成：

![image-20200607151620056](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607151620056.png)

**指令部件（完成取指令和分析指令）**

​	程序计数器 PC （指令计数器、指令地址寄存器） 【提供将要执 行指令的指令地址。】

​	指令寄存器 IR 【存放当前正在执行的指令】

​	指令译码器 ID 

> 指令译码器是指令分析部件，对指令寄存器中的指令**操作码进行译码分析**，产生相应操作的控制电位， 提供给微操作控制信号形成部件。
>
> 对寻址方式字段进行译码分析，以控制操作数有效地址的形成。 

​	地址形成部件 

> 根据机器所规定的各种寻址方式，形成操作数有效 地址。
>
> 在一些微、小型机中，为简化硬件逻辑，通常不设 置专门的地址形成部件，而是借用运算器实现有效 地址的计算。

**时序控制部件**（产生一系列时序信号，为各个微操作定时，以保证各个微操作的执行顺序。 ）

​	从宏观(即程序控制)上看，计算机的解题过程实质 上是指令序列即一条条指令的执行过程。 
​	从微观(即指令控制)上看，计算机的解题过程是微操作序列即一个个(或一组组)**微操作**的执行过程。 

>  	微操作：机器最简单的基本操作 
>  	一条指令的执行过程可以分解为若干微操作。这些 微操作有着严格的时间顺序要求，不可随意颠倒。 

​	包含：   脉冲源、启停电路、时序信号发生器 

**微操作控制信号形成部件** 

​		根据指令部件提供的操作控制电位、时 序部件所提供的各种时序信号以及有关的状态 条件，产生机器所需要的各种微操作控制信号

**中断控制逻辑（中断机构）** （用于实现异常情况和特殊请求的处理。 ）

**程序状态寄存器PSR**



###### 控制器的组成方式 

组合逻辑型

>  优点：速度快。巨型机和RISC机为了追求高速度采用 组合逻辑控制器。  
>
>  缺点：微操作信号发生器结构不规整，设计、调试、 维修较困难，难以实现设计自动化。一旦控制部件构 成之后，要想增加新的控制功能是不可能的。 

存储逻辑型 

> 优点：设计规整，调试、维修便利，更改、扩充指令 方便，易于实现自动化设计。 
>
> 缺点：由于增加了一级控制存储器，所以指令的执行 速度比组合逻辑控制器慢。 

组合逻辑和存储逻辑结合型



##### 运算器

1. 执行所有的算术运算
2. 执行所有的逻辑运算，并进行逻辑测试（如零值测试或两个值的比较等）。 



##### 主要寄存器

在CPU中至少要有六类寄存器： 

- 数据缓冲寄存器（DR）
- 指令寄存器（IR）
- 程序计数器（PC）
- 地址寄存器（AR）
- 通用寄存器（R0-R3）
- 状态条件寄存器（PSW） 





## 5.2 指令周期

### 5.2.1 指令周期的基本概念 

**指令周期 :**   CPU从内存取出一条指令并执行完这条指令的时间总和。 

> 由于各种指令的操作功能不同，繁简程度不同，因此各种指令的指令周期也不尽相同。 

**CPU周期 :** （机器周期）指CPU从内存读取一条指令字的所需的最短时间。指令周期中的某一工作阶段所需的时间 

>  一般机器的CPU周期有取指周期、取数周期、执行周期， 中断周期等。 

**时钟周期 :**  （节拍）通常称为节拍脉冲或T周期。一个CPU周期包含若干个时钟周期T。  

> 1个指令周期 = 若干个CPU周期；              1个CPU周期 = 若干T周期 
>
> 一个节拍对应一个电位信号，控制一个或几个微操作的执行。 

![image-20200607230619349](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230619349.png)

![image-20200608104759727](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608104759727.png)

![image-20200608104916056](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608104916056.png)

### 5.2.2 MOV指令的指令周期 

![image-20200607230659331](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230659331.png)

![image-20200607230752011](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230752011.png)

![image-20200607230849427](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230849427.png)

### 5.2.3 LAD指令的指令周期 

![image-20200607230922251](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230922251.png)

![image-20200607230933422](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230933422.png)

### 5.2.4 ADD指令的指令周期 

![image-20200607230957982](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607230957982.png)

![image-20200607231007921](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231007921.png)

### 5.2.5 STO指令的指令周期 

![image-20200607231022087](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231022087.png)

![image-20200607231030031](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231030031.png)

### 5.2.6  JMP指令的指令周期 

![image-20200607231045659](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231045659.png)

![image-20200607231058704](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231058704.png)

### 5.2.7  指令的指令周期表示 

#### 指令周期的方框图语言表示 

方法： 

- 方框——表示一个CPU周期  方框内内容——表示数据通路操作或控制操作 
- 菱形符号——表示判别或测试，不单独占用一 个CPU周期，依附于紧接它的前面一个方案的CPU周期 
- ~——表示公操作 

![image-20200607231335688](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231335688.png)

![image-20200607231517963](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231517963.png)

![image-20200607231450329](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200607231450329.png)





## 5.3 时序产生器和控制方式 

### 5.3.1 组合逻辑电路和时序逻辑电路 

![image-20200608101433544](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608101433544.png)![image-20200608101359219](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608101359219.png)

![image-20200608101751117](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608101751117.png)

### 5.3.2  时序信号的作用和体制 

#### 时序信号的作用 

1. 控制器用时序信号指挥机器的工作 
2. CPU可以用时序信号（CPU周期）信息来辨认 从内存中取出的是指令（在取指周期）还是 数据（在执行周期） 
3. 在一个CPU周期中,时钟脉冲可以对CPU的动 作进行严格的约束 
4. 操作控制器发出的各种信号是时间（时序信 号）和空间（部件操作信号）的函数。 

#### 时序信号的体制 

1. 用于产生一系列时序信号，为各个微操作定时，以 保证各个微操作的执行顺序。 
2. 从宏观(即程序控制)上看，计算机的解题过程实质 上是指令序列即一条条指令的执行过程。 
3. 从微观(即指令控制)上看，计算机的解题过程是微 操作序列即一个个(或一组组)微操作的执行过程。 
4. 时序系统是控制器的心脏，由它为指令的执行提供 各种定时信号。通常，设计时序系统主要是针对同 步控制方式的。
5. 时序信号发生器用于产生机器所需的各种时序信号， 以便控制有关部件在不同的时间完成不同的微操作。 
6. 不同的机器，有着不同的时序信号。在同步控制的 机器中，一般包括周期、节拍、脉冲等三级时序信 号。 



### 5.3.3  时序信号产生器 

**功能：**产生时序信号 

- 各种型号的计算机产生时序信号的电路各不相同 
- 大、中型计算机的时序电路复杂，微型计算机的 时序电路简单 

 **构成：**

 <img src="C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608110619180.png" alt="image-20200608110619180" style="zoom: 80%;" />

- 时钟源
- 环形脉冲发生器
- 节拍脉冲和读写时序译码逻辑
- 启停控制逻辑 

### 5.3.4  控制方式

计算机执行指令的过程常用的控制方式有同步控制、异步控制和联合控制。 

#### 同步控制方式：

- 任何指令的运行或指令中各个微操作的执行，均 由确定的具有统一基准时标的时序信号所控制。 
- 即所有的操作均由统一的时钟控制，在标准的时 间内完成。 
- 在同步控制方式下，每个时序信号的结束就意味 着安排完成的工作已经完成，随即开始执行后续 的微操作或自动转向下条指令的运行。 

#### 异步控制方式 ：

- 没有统一的同步信号，采用问答方式进行时 序协调，将前一操作的回答信号作为下一操 作的启动信号。 
- 异步控制方式不仅要区分不同指令对应的微 操作序列的长短，而且要区分其中每个微操 作的繁简，每条指令、每个微操作需要多少 时间就占用多少时间。 
- 这种方式不再有统一的周期、节拍，各个操 作之间采用应答方式衔接，前一操作完成后 给出回答信号，启动下一个操作。 

#### 联合控制方式：

- 在功能部件内部采用同步方式或以同步方式 为主的控制方式；在功能部件之间采用异步 方式。 
- 通常对可以统一的微操作采用同步控制，对 难以统一的微操作采用异步控制。 





## 5.4硬连线控制器 

![image-20200608110751269](C:\Users\Wyatt\AppData\Roaming\Typora\typora-user-images\image-20200608110751269.png)

硬连线：同步逻辑、繁，快，贵，难改

- 一条指令多个时钟周期
- 一个时钟周期一个状态
- 一个状态对应一组并发信号 



## 5.5微程序控制器

微程序：存储逻辑、简、慢、廉，易改

- 将并发信号事先存储为微指令
- 一条指令对应多条微指令
- 状态等同与存储器地址 

### 5.5.1 微程序控制原理 

将完成指令所需的控制信号按格式编写成微指令， 存放到控制存储器 

> 一条机器指令对应一段微程序（多条微指令）
>
> 指令取指执行➡微程序的执行➡执行多条微指令➡依次生成控制信号 

存储技术和程序设计相结合，回避复杂的同步时序逻辑设计 

### 5.5.2 微程序设计技术 

### 5.5.3 微指令格式



## 5.6流水线CPU

### 5.6.1  流水线相关概念 

### 5.6.2  流水线特点及分类 

### 5.6.3  流水线性能分析 

### 5.6.4 流水线中的主要问题 



# 第六章：存储

## 6.4存储器容量扩充》》